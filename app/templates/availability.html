{% extends "base.html" %}

{% block title %}Verfügbarkeiten - HCC Einsatzplanung{% endblock %}

{% block content %}
<div class="availability-container">
    <h1>Meine Verfügbarkeiten</h1>

    <div class="availability-grid">
        <div class="availability-form-container">
            <h2>Neue Verfügbarkeit hinzufügen</h2>

            <form
                hx-post="/api/availability/add-htmx"
                hx-target="#calendar-container"
                hx-swap="innerHTML"
                class="availability-form">

                <div class="form-group">
                    <label for="name">Bezeichnung</label>
                    <input type="text" id="name" name="name" required>
                </div>

                <div class="form-group">
                    <label for="start_date">Startdatum</label>
                    <input type="date" id="start_date" name="start_date" required>
                </div>

                <div class="form-group">
                    <label for="start_time">Startzeit</label>
                    <input type="time" id="start_time" name="start_time" required>
                </div>

                <div class="form-group">
                    <label for="end_date">Enddatum</label>
                    <input type="date" id="end_date" name="end_date" required>
                </div>

                <div class="form-group">
                    <label for="end_time">Endzeit</label>
                    <input type="time" id="end_time" name="end_time" required>
                </div>

                <button type="submit">Hinzufügen</button>
            </form>
        </div>

        <div class="calendar-wrapper">
            <h2>Meine Sperrtermine</h2>

            <div class="calendar-nav">
                <button
                    hx-get="/api/availability/calendar?month={{ current_month - 1 if current_month > 1 else 12 }}&year={{ current_year if current_month > 1 else current_year - 1 }}"
                    hx-target="#calendar-container"
                    hx-swap="innerHTML"
                    class="prev-month">
                    &lt; Vorheriger Monat
                </button>

                <span class="current-month">
                    {% if current_month and current_year %}
                        {{ month_name }} {{ current_year }}
                    {% else %}
                        Aktueller Monat
                    {% endif %}
                </span>

                <button
                    hx-get="/api/availability/calendar?month={{ current_month + 1 if current_month < 12 else 1 }}&year={{ current_year if current_month < 12 else current_year + 1 }}"
                    hx-target="#calendar-container"
                    hx-swap="innerHTML"
                    class="next-month">
                    Nächster Monat &gt;
                </button>
            </div>

            <div id="calendar-container" hx-get="/api/availability/calendar" hx-trigger="load" hx-swap="innerHTML">
                <!-- Kalender wird per HTMX geladen -->
                <div class="loading">Kalender wird geladen...</div>
            </div>
        </div>
    </div>
</div>
{% endblock %}